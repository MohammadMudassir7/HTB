import React, { useState, useEffect } from 'react';
import { Edit3, Eye, Shield, Zap, Code, Globe, Award, Target, Lock, Mail, Github, Twitter, Linkedin, ExternalLink, Save, X } from 'lucide-react';

// Mock data - easily editable
const initialContent = {
  hero: {
    name: "Alex Morgan",
    title: "Senior Penetration Tester & Bug Bounty Hunter",
    subtitle: "Uncovering vulnerabilities before attackers do",
    avatar: "https://placehold.co/400x400/1e293b/64748b?text=AM"
  },
  about: {
    bio: "With over 7 years of experience in cybersecurity, I specialize in penetration testing, vulnerability assessment, and bug bounty hunting. I've helped Fortune 500 companies secure their infrastructure and have discovered critical vulnerabilities in major platforms earning over $250,000 in bounties.",
    skills: ["Web Application Security", "Mobile App Testing", "Network Penetration Testing", "API Security", "Cloud Security (AWS/Azure)", "Social Engineering", "Reverse Engineering", "Automated Scanning"]
  },
  certifications: [
    { name: "OSCP (Offensive Security Certified Professional)", provider: "Offensive Security", year: "2020", icon: "ðŸ”’" },
    { name: "CEH (Certified Ethical Hacker)", provider: "EC-Council", year: "2019", icon: "ðŸ›¡ï¸" },
    { name: "CISSP (Certified Information Systems Security Professional)", provider: "ISCÂ²", year: "2021", icon: "ðŸŽ¯" }
  ],
  achievements: [
    { title: "Top 10 Bug Bounty Hunter", platform: "HackerOne", year: "2023", amount: "$85,000" },
    { title: "Critical Vulnerability Discovery", platform: "GitHub Security Lab", year: "2022", amount: "$25,000" },
    { title: "Security Research Publication", platform: "Black Hat Conference", year: "2021", amount: "" }
  ],
  projects: [
    {
      title: "Automated Bug Bounty Scanner",
      description: "Custom Python tool that automates reconnaissance and vulnerability scanning for bug bounty programs",
      technologies: ["Python", "Burp Suite API", "Nmap", "SQLMap"],
      live: " https://github.com/alex-security/bugbounty-scanner "
    },
    {
      title: "Web Application Firewall Bypass Research",
      description: "Research paper and proof-of-concept demonstrating novel WAF bypass techniques",
      technologies: ["JavaScript", "Node.js", "OWASP ZAP", "Custom Scripts"],
      live: "https://github.com/alex-security/waf-bypass "
    },
    {
      title: "Mobile Security Testing Framework",
      description: "Comprehensive framework for testing Android and iOS application security",
      technologies: ["Frida", "MobSF", "Burp Suite", "ADB"],
      live: "https://github.com/alex-security/mobile-security-framework "
    }
  ],
  contact: {
    email: "alex.morgan@security.expert",
    github: "alex-security",
    twitter: "@alex_security",
    linkedin: "alex-morgan-cybersecurity"
  }
};

const App = () => {
  const [content, setContent] = useState(() => {
    const saved = localStorage.getItem('portfolioContent');
    return saved ? JSON.parse(saved) : initialContent;
  });
  const [isEditing, setIsEditing] = useState(false);
  const [editSection, setEditSection] = useState(null);
  const [tempContent, setTempContent] = useState({});
  const [adminMode, setAdminMode] = useState(false);
  const [adminPassword, setAdminPassword] = useState('');
  const [showAdminModal, setShowAdminModal] = useState(false);

  // Admin password (in real app, this would be handled securely)
  const ADMIN_PASSWORD = 'pentester2025';

  const handleAdminLogin = () => {
    if (adminPassword === ADMIN_PASSWORD) {
      setAdminMode(true);
      setShowAdminModal(false);
      setAdminPassword('');
    } else {
      alert('Incorrect password');
    }
  };

  const startEditing = (section) => {
    setEditSection(section);
    setTempContent(content[section]);
    setIsEditing(true);
  };

  const saveChanges = () => {
    const updatedContent = { ...content, [editSection]: tempContent };
    setContent(updatedContent);
    localStorage.setItem('portfolioContent', JSON.stringify(updatedContent));
    setIsEditing(false);
    setEditSection(null);
    setTempContent({});
  };

  const cancelEdit = () => {
    setIsEditing(false);
    setEditSection(null);
    setTempContent({});
  };

  const updateTempContent = (field, value) => {
    setTempContent(prev => ({ ...prev, [field]: value }));
  };

  const updateArrayContent = (section, index, field, value) => {
    const updatedArray = [...tempContent];
    updatedArray[index] = { ...updatedArray[index], [field]: value };
    setTempContent(updatedArray);
  };

  const EditButton = ({ section }) => (
    adminMode && (
      <button
        onClick={() => startEditing(section)}
        className="absolute top-2 right-2 p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-lg"
      >
        <Edit3 size={16} />
      </button>
    )
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-100">
      {/* Admin Login */}
      {!adminMode && (
        <button
          onClick={() => setShowAdminModal(true)}
          className="fixed top-4 right-4 p-2 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors shadow-lg z-50"
        >
          <Lock size={20} />
        </button>
      )}

      {/* Admin Modal */}
      {showAdminModal && (
        <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
          <div className="bg-slate-800 p-6 rounded-lg w-96">
            <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
              <Lock size={24} />
              Admin Login
            </h3>
            <input
              type="password"
              value={adminPassword}
              onChange={(e) => setAdminPassword(e.target.value)}
              placeholder="Enter admin password"
              className="w-full p-2 mb-4 bg-slate-700 border border-slate-600 rounded text-white"
              onKeyPress={(e) => e.key === 'Enter' && handleAdminLogin()}
            />
            <div className="flex gap-2">
              <button
                onClick={handleAdminLogin}
                className="flex-1 bg-green-600 hover:bg-green-700 p-2 rounded transition-colors"
              >
                Login
              </button>
              <button
                onClick={() => setShowAdminModal(false)}
                className="flex-1 bg-slate-600 hover:bg-slate-700 p-2 rounded transition-colors"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Header */}
      <header className="relative overflow-hidden">
        <div className="absolute inset-0 bg-gradient-to-r from-blue-900/20 to-purple-900/20"></div>
        <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
          <div className="text-center">
            <div className="relative inline-block mb-6">
              <img
                src={content.hero.avatar}
                alt={content.hero.name}
                className="w-32 h-32 rounded-full border-4 border-blue-500/30 shadow-2xl"
              />
              {adminMode && (
                <button
                  onClick={() => startEditing('hero')}
                  className="absolute bottom-0 right-0 bg-blue-600 p-2 rounded-full hover:bg-blue-700 transition-colors"
                >
                  <Edit3 size={16} />
                </button>
              )}
            </div>
            <h1 className="text-4xl md:text-6xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent mb-4">
              {content.hero.name}
            </h1>
            <p className="text-xl md:text-2xl text-blue-300 mb-2">{content.hero.title}</p>
            <p className="text-lg text-slate-300 max-w-2xl mx-auto">{content.hero.subtitle}</p>
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        {/* About Section */}
        <section className="mb-20 relative">
          <EditButton section="about" />
          <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700/50">
            <div className="flex items-center gap-3 mb-6">
              <Shield className="text-blue-400" size={28} />
              <h2 className="text-3xl font-bold">About Me</h2>
            </div>
            {isEditing && editSection === 'about' ? (
              <div className="space-y-4">
                <textarea
                  value={tempContent.bio || ''}
                  onChange={(e) => updateTempContent('bio', e.target.value)}
                  className="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white min-h-32"
                  placeholder="Bio..."
                />
                <div>
                  <label className="block text-sm font-medium mb-2">Skills (comma separated)</label>
                  <input
                    value={tempContent.skills ? tempContent.skills.join(', ') : ''}
                    onChange={(e) => updateTempContent('skills', e.target.value.split(',').map(s => s.trim()))}
                    className="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white"
                    placeholder="Skills..."
                  />
                </div>
                <div className="flex gap-3">
                  <button
                    onClick={saveChanges}
                    className="flex items-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <Save size={18} />
                    Save
                  </button>
                  <button
                    onClick={cancelEdit}
                    className="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <X size={18} />
                    Cancel
                  </button>
                </div>
              </div>
            ) : (
              <>
                <p className="text-slate-300 text-lg leading-relaxed mb-6">{content.about.bio}</p>
                <div className="flex flex-wrap gap-2">
                  {content.about.skills.map((skill, index) => (
                    <span
                      key={index}
                      className="px-3 py-1 bg-blue-900/30 border border-blue-700/50 rounded-full text-blue-300 text-sm"
                    >
                      {skill}
                    </span>
                  ))}
                </div>
              </>
            )}
          </div>
        </section>

        {/* Certifications */}
        <section className="mb-20 relative">
          <EditButton section="certifications" />
          <div className="flex items-center gap-3 mb-8">
            <Award className="text-purple-400" size={28} />
            <h2 className="text-3xl font-bold">Certifications</h2>
          </div>
          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {isEditing && editSection === 'certifications' ? (
              <div className="space-y-4">
                {tempContent.map((cert, index) => (
                  <div key={index} className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50">
                    <input
                      value={cert.name || ''}
                      onChange={(e) => updateArrayContent('certifications', index, 'name', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white mb-2"
                      placeholder="Certification Name"
                    />
                    <input
                      value={cert.provider || ''}
                      onChange={(e) => updateArrayContent('certifications', index, 'provider', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white mb-2"
                      placeholder="Provider"
                    />
                    <input
                      value={cert.year || ''}
                      onChange={(e) => updateArrayContent('certifications', index, 'year', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white"
                      placeholder="Year"
                    />
                  </div>
                ))}
                <div className="flex gap-3">
                  <button
                    onClick={saveChanges}
                    className="flex items-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <Save size={18} />
                    Save
                  </button>
                  <button
                    onClick={cancelEdit}
                    className="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <X size={18} />
                    Cancel
                  </button>
                </div>
              </div>
            ) : (
              content.certifications.map((cert, index) => (
                <div
                  key={index}
                  className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50 hover:border-blue-500/50 transition-colors"
                >
                  <div className="text-2xl mb-3">{cert.icon}</div>
                  <h3 className="text-xl font-bold text-blue-300 mb-2">{cert.name}</h3>
                  <p className="text-slate-400 mb-2">{cert.provider}</p>
                  <p className="text-slate-500">{cert.year}</p>
                </div>
              ))
            )}
          </div>
        </section>

        {/* Achievements */}
        <section className="mb-20 relative">
          <EditButton section="achievements" />
          <div className="flex items-center gap-3 mb-8">
            <Target className="text-green-400" size={28} />
            <h2 className="text-3xl font-bold">Bug Bounty Achievements</h2>
          </div>
          <div className="space-y-6">
            {isEditing && editSection === 'achievements' ? (
              <div className="space-y-4">
                {tempContent.map((achievement, index) => (
                  <div key={index} className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50">
                    <input
                      value={achievement.title || ''}
                      onChange={(e) => updateArrayContent('achievements', index, 'title', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white mb-2"
                      placeholder="Achievement Title"
                    />
                    <div className="grid grid-cols-2 gap-2">
                      <input
                        value={achievement.platform || ''}
                        onChange={(e) => updateArrayContent('achievements', index, 'platform', e.target.value)}
                        className="p-2 bg-slate-700 border border-slate-600 rounded text-white"
                        placeholder="Platform"
                      />
                      <input
                        value={achievement.year || ''}
                        onChange={(e) => updateArrayContent('achievements', index, 'year', e.target.value)}
                        className="p-2 bg-slate-700 border border-slate-600 rounded text-white"
                        placeholder="Year"
                      />
                      <input
                        value={achievement.amount || ''}
                        onChange={(e) => updateArrayContent('achievements', index, 'amount', e.target.value)}
                        className="p-2 bg-slate-700 border border-slate-600 rounded text-white col-span-2"
                        placeholder="Amount"
                      />
                    </div>
                  </div>
                ))}
                <div className="flex gap-3">
                  <button
                    onClick={saveChanges}
                    className="flex items-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <Save size={18} />
                    Save
                  </button>
                  <button
                    onClick={cancelEdit}
                    className="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <X size={18} />
                    Cancel
                  </button>
                </div>
              </div>
            ) : (
              content.achievements.map((achievement, index) => (
                <div
                  key={index}
                  className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50 hover:border-green-500/50 transition-colors"
                >
                  <div className="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div>
                      <h3 className="text-xl font-bold text-green-300 mb-2">{achievement.title}</h3>
                      <p className="text-slate-400">{achievement.platform} â€¢ {achievement.year}</p>
                    </div>
                    {achievement.amount && (
                      <div className="mt-2 md:mt-0">
                        <span className="px-4 py-2 bg-green-900/30 border border-green-700/50 rounded-full text-green-300 font-bold">
                          {achievement.amount}
                        </span>
                      </div>
                    )}
                  </div>
                </div>
              ))
            )}
          </div>
        </section>

        {/* Projects */}
        <section className="mb-20 relative">
          <EditButton section="projects" />
          <div className="flex items-center gap-3 mb-8">
            <Code className="text-purple-400" size={28} />
            <h2 className="text-3xl font-bold">Security Projects</h2>
          </div>
          <div className="space-y-8">
            {isEditing && editSection === 'projects' ? (
              <div className="space-y-4">
                {tempContent.map((project, index) => (
                  <div key={index} className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50">
                    <input
                      value={project.title || ''}
                      onChange={(e) => updateArrayContent('projects', index, 'title', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white mb-2 text-lg font-bold"
                      placeholder="Project Title"
                    />
                    <textarea
                      value={project.description || ''}
                      onChange={(e) => updateArrayContent('projects', index, 'description', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white mb-3 min-h-20"
                      placeholder="Description..."
                    />
                    <input
                      value={project.technologies ? project.technologies.join(', ') : ''}
                      onChange={(e) => updateArrayContent('projects', index, 'technologies', e.target.value.split(',').map(t => t.trim()))}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white mb-3"
                      placeholder="Technologies (comma separated)"
                    />
                    <input
                      value={project.live || ''}
                      onChange={(e) => updateArrayContent('projects', index, 'live', e.target.value)}
                      className="w-full p-2 bg-slate-700 border border-slate-600 rounded text-white"
                      placeholder="Live Link"
                    />
                  </div>
                ))}
                <div className="flex gap-3">
                  <button
                    onClick={saveChanges}
                    className="flex items-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <Save size={18} />
                    Save
                  </button>
                  <button
                    onClick={cancelEdit}
                    className="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <X size={18} />
                    Cancel
                  </button>
                </div>
              </div>
            ) : (
              content.projects.map((project, index) => (
                <div
                  key={index}
                  className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50 hover:border-purple-500/50 transition-colors"
                >
                  <div className="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4">
                    <div className="flex-1">
                      <h3 className="text-xl font-bold text-purple-300 mb-3">{project.title}</h3>
                      <p className="text-slate-300 mb-4">{project.description}</p>
                      <div className="flex flex-wrap gap-2 mb-4">
                        {project.technologies.map((tech, techIndex) => (
                          <span
                            key={techIndex}
                            className="px-3 py-1 bg-purple-900/30 border border-purple-700/50 rounded-full text-purple-300 text-sm"
                          >
                            {tech}
                          </span>
                        ))}
                      </div>
                    </div>
                    <a
                      href={project.live}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="flex items-center gap-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg transition-colors whitespace-nowrap"
                    >
                      <ExternalLink size={18} />
                      View Project
                    </a>
                  </div>
                </div>
              ))
            )}
          </div>
        </section>

        {/* Contact */}
        <section className="relative">
          <EditButton section="contact" />
          <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700/50">
            <div className="flex items-center gap-3 mb-6">
              <Mail className="text-blue-400" size={28} />
              <h2 className="text-3xl font-bold">Get In Touch</h2>
            </div>
            {isEditing && editSection === 'contact' ? (
              <div className="space-y-4">
                <input
                  value={tempContent.email || ''}
                  onChange={(e) => updateTempContent('email', e.target.value)}
                  className="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white"
                  placeholder="Email"
                />
                <input
                  value={tempContent.github || ''}
                  onChange={(e) => updateTempContent('github', e.target.value)}
                  className="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white"
                  placeholder="GitHub Username"
                />
                <input
                  value={tempContent.twitter || ''}
                  onChange={(e) => updateTempContent('twitter', e.target.value)}
                  className="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white"
                  placeholder="Twitter Handle"
                />
                <input
                  value={tempContent.linkedin || ''}
                  onChange={(e) => updateTempContent('linkedin', e.target.value)}
                  className="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white"
                  placeholder="LinkedIn Profile"
                />
                <div className="flex gap-3">
                  <button
                    onClick={saveChanges}
                    className="flex items-center gap-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <Save size={18} />
                    Save
                  </button>
                  <button
                    onClick={cancelEdit}
                    className="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors"
                  >
                    <X size={18} />
                    Cancel
                  </button>
                </div>
              </div>
            ) : (
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div className="space-y-4">
                  <a
                    href={`mailto:${content.contact.email}`}
                    className="flex items-center gap-3 p-4 bg-slate-700/50 hover:bg-slate-700 rounded-xl transition-colors"
                  >
                    <Mail className="text-blue-400" size={20} />
                    <span className="text-slate-300">{content.contact.email}</span>
                  </a>
                  <a
                    href={`https://github.com/${content.contact.github}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex items-center gap-3 p-4 bg-slate-700/50 hover:bg-slate-700 rounded-xl transition-colors"
                  >
                    <Github className="text-slate-400" size={20} />
                    <span className="text-slate-300">{content.contact.github}</span>
                  </a>
                </div>
                <div className="space-y-4">
                  <a
                    href={`https://twitter.com/${content.contact.twitter.replace('@', '')}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex items-center gap-3 p-4 bg-slate-700/50 hover:bg-slate-700 rounded-xl transition-colors"
                  >
                    <Twitter className="text-blue-400" size={20} />
                    <span className="text-slate-300">{content.contact.twitter}</span>
                  </a>
                  <a
                    href={`https://linkedin.com/in/${content.contact.linkedin}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex items-center gap-3 p-4 bg-slate-700/50 hover:bg-slate-700 rounded-xl transition-colors"
                  >
                    <Linkedin className="text-blue-600" size={20} />
                    <span className="text-slate-300">{content.contact.linkedin}</span>
                  </a>
                </div>
              </div>
            )}
          </div>
        </section>
      </main>

      <footer className="border-t border-slate-700/50 py-8 text-center text-slate-400">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <p>Â© 2025 {content.hero.name}. All vulnerabilities responsibly disclosed.</p>
          <p className="mt-2 text-sm">Designed with security in mind â€¢ Built for the bug bounty community</p>
        </div>
      </footer>
    </div>
  );
};

export default App;